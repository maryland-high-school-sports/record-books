## Data Exploration of Volleyball (Fall)

#### Sam Benning

### Introduction

This notebook serves as an example of basic data analysis of Maryland high school sports records.

### Loading Libraries

```{r}
library(tidyverse)
library(ggplot2)
```

### Loading Data

```{r}
vb <- read.csv("https://raw.githubusercontent.com/maryland-high-school-sports/record-books/refs/heads/main/fall/volleyball/championships.csv")

head(vb) #displays a preview of the data
```

### Basic Aggregation

Some examples using group_by() and summarize()

Finding which school has won the most championships:

```{r}
vb |> group_by(School, Status) |> filter(Status == "Champion") |>
  summarize(
    count = n()
  ) |>
  arrange(desc(count))
```

Williamsport has won 16 championships in volleyball since the beginning of these records.

A more complex analysis: Which team has won the most back-to-back championships?

```{r}
vb |> group_by(School, Status) |> filter(Status == "Champion") |>
mutate(consecutive = Year - lag(Year) == 1) %>% #check for consecutive years using lag
  summarize(
    back_to_back = sum(consecutive, na.rm = TRUE) #count consecutive occurrences
  ) |>
  arrange(desc(back_to_back))
```

Centennial has won in consecutive years 9 times. Let's see which years they did it in:

```{r}
vb |> select(School, Year, Status) |> filter(School == "Centennial" & Status == "Champion")
```

They have had a number of streaks with more than just back-to-back titles. Wow!

### Visualizations

Let's say we wanted to visualize Centennial's dominance in volleyball over the years. We can create a stacked bar chart that shows how many times they succeeded in the state tournament, and organize it by each decade.

```{r}
#Create a new variable `Era` to show Centennial's success through each decade:
centennial <- vb |> filter(School == "Centennial") |> mutate(Era = case_when(
    Year >= 1970 & Year < 1980 ~ "1970s",
    Year >= 1980 & Year < 1990 ~ "1980s",
    Year >= 1990 & Year < 2000 ~ "1990s",
    Year >= 2000 & Year < 2010 ~ "2000s",
    Year >= 2010 & Year < 2020 ~ "2010s",
    Year >= 2020 & Year < 2030 ~ "2020s",
    TRUE ~ "Other"  #For unexpected values
  )) |>
    mutate(
    Era = factor(Era, levels = c("1970s", "1980s", "1990s", "2000s", "2010s", "2020s")) #This edit allows the era's to be in order when we plot them
  ) |>
  group_by(Era, Status) %>% 
  summarise(Count = n()) #This is how we save the data to a dataframe that we will use for our chart

#Plot the stacked bar chart using ggplot
ggplot() + 
  geom_bar(
    data=centennial, 
    aes(x=Era, weight=Count, fill=Status)) + 
  coord_flip() +
  labs(title = "Centennial's Championship Dominance Spread Across Two Decades")
```

### Notes/Caveats/Problems

None at the moment!
